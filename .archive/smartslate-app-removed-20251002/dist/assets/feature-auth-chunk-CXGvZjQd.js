import{r as o,j as e}from"./react-vendor-chunk-Ifbrj989.js";import{c as C}from"./supabase-chunk-CR9ODFC2.js";const I={home:"/",portal:"/portal",portalUser:"/portal/:user",settings:"/portal/settings",publicProfile:"/:username"};function z(s){const t=(s||"user").toString().trim();return`/portal/${encodeURIComponent(t)}`}function Y(s){const t=(s||"user").toString().trim();return`/${encodeURIComponent(t)}`}const _={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_AUTH_REDIRECT_URL:"http://localhost:5173/auth/callback",VITE_GOOGLE_REDIRECT_URL:"http://localhost:5173/auth/callback",VITE_SITE_URL:"http://localhost:5173",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im95anNsc3pyeWdjYWpkcHdneGJlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxNDgyNjEsImV4cCI6MjA3MDcyNDI2MX0.kMjNtKIrzmYHEKJFKsY75-kp8PeOib2BYDxHZ_lmZ-Y",VITE_SUPABASE_URL:"https://oyjslszrygcajdpwgxbe.supabase.co"},f=_;function u(s){const t=f[s];return typeof t=="string"&&t!==""?t:void 0}function R(s){const t=u(s);return t==="true"||t==="1"}const p={supabaseUrl:u("VITE_SUPABASE_URL"),supabaseAnonKey:u("VITE_SUPABASE_ANON_KEY"),siteUrl:u("VITE_SITE_URL")||(f.DEV?"http://localhost:5173":""),authRedirectUrl:u("VITE_AUTH_REDIRECT_URL"),googleRedirectUrl:u("VITE_GOOGLE_REDIRECT_URL"),appName:u("VITE_APP_NAME")||"SmartSlate",appVersion:u("VITE_APP_VERSION")||"1.0.0",mode:f.MODE,isDev:f.DEV,isProd:f.PROD,isStaging:f.MODE==="staging",enableAnalytics:R("VITE_ENABLE_ANALYTICS"),sentryDsn:u("VITE_SENTRY_DSN")};function A(){const s=[];if(p.supabaseUrl||s.push("VITE_SUPABASE_URL"),p.supabaseAnonKey||s.push("VITE_SUPABASE_ANON_KEY"),s.length){const t=`Missing required environment variables: ${s.join(", ")}`;throw console.error(t),p.isDev&&console.info(`ðŸ’¡ Tip: Create a .env file in the project root with the required variables.
   You can copy env.example as a template.`),new Error(t)}}let b=null;function v(){if(b)return b;A();const s=p.supabaseUrl,t=p.supabaseAnonKey;return b=C(s,t,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}}),b}function E(s){const t=s.trim();return/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(t)?{kind:"email",email:t.toLowerCase()}:{kind:"unknown",raw:s}}function N({value:s,onChange:t,placeholder:r}){o.useEffect(()=>{const a=E(s);t(s,a)},[s]);function i(a){t(a,E(a))}return e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm text-white/70",children:"Email"}),e.jsx("input",{className:"input",placeholder:r??"name@company.com",value:s,onChange:a=>i(a.target.value),inputMode:"email",autoComplete:"username"})]})}async function U(s){const{identifier:t,password:r}=s;if(t.kind!=="email")throw new Error("Enter a valid email");const{error:i}=await v().auth.signInWithPassword({email:t.email,password:r});if(i)throw new Error(i.message);try{const a=t.email,l=[],n=new URLSearchParams(window.location.search).get("redirectTo")||void 0;await fetch("/api/session/issue"+(n?`?redirectTo=${encodeURIComponent(n)}`:""),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({sub:a,roles:l})}),n?window.location.assign(n):window.location.assign(I.portal)}catch(a){console.error("Failed to issue session cookie",a)}}async function T(s){const{identifier:t,password:r}=s;if(t.kind!=="email")throw new Error("Enter a valid email");const i=p.authRedirectUrl||p.siteUrl||void 0,{error:a}=await v().auth.signUp({email:t.email,password:r,options:{emailRedirectTo:i}});if(a)throw new Error(a.message)}function S(){const[s,t]=o.useState(!1);async function r(){try{t(!0);const i=p.googleRedirectUrl||`${window.location.origin}/auth/callback`,{data:a,error:l}=await v().auth.signInWithOAuth({provider:"google",options:{redirectTo:i}});if(l)throw l;a?.url&&(window.location.href=a.url)}catch(i){alert(i instanceof Error?i.message:"Google sign-in failed")}finally{t(!1)}}return e.jsxs("button",{type:"button",onClick:r,disabled:s,className:"w-full inline-flex items-center justify-center gap-2 border border-slate-200 bg-white hover:bg-slate-50 text-slate-900 rounded-xl px-4 py-3 text-sm font-medium transition pressable",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",className:"h-5 w-5",children:[e.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12 s5.373-12,12-12c3.059,0,5.842,1.153,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24 s8.955,20,20,20s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),e.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.818C14.655,16.108,18.961,13,24,13c3.059,0,5.842,1.153,7.961,3.039l5.657-5.657 C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),e.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.191l-6.192-5.238C29.211,35.091,26.715,36,24,36 c-5.192,0-9.598-3.317-11.247-7.946l-6.513,5.02C9.54,39.556,16.227,44,24,44z"}),e.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.236-2.231,4.166-4.093,5.571 c0.001-0.001,0.002-0.001,0.003-0.002l6.192,5.238C36.961,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]}),e.jsx("span",{className:s?"opacity-70 animate-pulse-subtle":"",children:s?"Connectingâ€¦":"Continue with Google"})]})}function k({className:s=""}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",className:s,"aria-hidden":"true",children:[e.jsx("path",{d:"M1.5 12s3.5-7 10.5-7 10.5 7 10.5 7-3.5 7-10.5 7S1.5 12 1.5 12Z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}function P({className:s=""}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",className:s,"aria-hidden":"true",children:[e.jsx("path",{d:"M3 3l18 18"}),e.jsx("path",{d:"M10.6 10.6A3 3 0 0 0 12 15a3 3 0 0 0 2.4-1.2"}),e.jsx("path",{d:"M9.9 4.2A10.8 10.8 0 0 1 12 4.1c7 0 10.5 7 10.5 7a19.7 19.7 0 0 1-4.1 4.9"}),e.jsx("path",{d:"M6.1 6.7C3.7 8.5 2 11.1 2 11.1s3.5 7 10.5 7c1.5 0 2.9-.3 4.1-.8"})]})}function y({label:s,value:t,onChange:r,placeholder:i,autoComplete:a,name:l}){const[n,d]=o.useState(!1);return e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm text-white/70",children:s}),e.jsxs("div",{className:"relative group animate-fade-in-up",children:[e.jsx("input",{className:"input pr-12",type:n?"text":"password",placeholder:i,value:t,onChange:c=>r(c.target.value),autoComplete:a,name:l}),e.jsxs("button",{type:"button","aria-label":n?"Hide password":"Show password","aria-pressed":n,onClick:()=>d(c=>!c),className:"absolute inset-y-0 right-2 my-auto h-8 w-8 rounded-md inline-flex items-center justify-center text-white/60 hover:text-white transition-colors pressable",title:n?"Hide password":"Show password",children:[e.jsx("span",{className:`transition-opacity duration-200 ${n?"opacity-0":"opacity-100"}`,children:e.jsx(k,{className:"h-5 w-5"})}),e.jsx("span",{className:`absolute transition-opacity duration-200 ${n?"opacity-100":"opacity-0"}`,children:e.jsx(P,{className:"h-5 w-5"})})]})]})]})}function L(){const[s,t]=o.useState(""),[r,i]=o.useState({kind:"unknown",raw:""}),[a,l]=o.useState(""),[n,d]=o.useState(!1),[c,x]=o.useState(null);async function g(m){m.preventDefault(),x(null),d(!0);try{await U({identifier:r,password:a})}catch(h){x(h instanceof Error?h.message:"Login failed")}finally{d(!1)}}return e.jsxs("form",{onSubmit:g,className:"space-y-5 animate-fade-in-up",children:[e.jsx(N,{value:s,onChange:(m,h)=>{t(m),i(h)}}),e.jsx(y,{label:"Password",value:a,onChange:l,placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",autoComplete:"current-password",name:"current-password"}),c&&e.jsx("p",{className:"text-sm text-red-400",children:c}),e.jsx("button",{type:"submit",className:"btn-primary w-full pressable",disabled:n,children:e.jsx("span",{className:n?"opacity-70 animate-pulse-subtle":"",children:n?"Signing inâ€¦":"Login"})}),e.jsxs("div",{className:"relative py-2 text-center text-xs text-white/40",children:[e.jsx("span",{className:"bg-[rgb(var(--card))] px-2 relative z-10 text-primary-500",children:"or"}),e.jsx("span",{className:"absolute left-0 right-0 top-1/2 -translate-y-1/2 h-px bg-white/10"})]}),e.jsx(S,{})]})}function V(s){if(!s)return{score:0,label:"Weak",percent:0,barClass:"bg-red-500",textClass:"text-red-400"};let t=0;s.length>=8&&(t+=1),s.length>=12&&(t+=1),/[a-z]/.test(s)&&(t+=1),/[A-Z]/.test(s)&&(t+=1),/\d/.test(s)&&(t+=1),/[^A-Za-z0-9]/.test(s)&&(t+=1);const r=s.toLowerCase();(["password","letmein","qwerty","123456","iloveyou"].some(c=>r.includes(c))||/(0123|1234|2345|3456|4567|5678|6789)/.test(s))&&(t=Math.min(t,2)),t=Math.max(0,Math.min(6,t));const a=Math.round(t/6*100);let l="Weak",n="bg-red-500",d="text-red-400";return t>=3&&t<=4&&(l="Medium",n="bg-amber-400",d="text-amber-300"),t===5&&(l="Strong",n="bg-green-500",d="text-green-400"),t>=6&&(l="Very strong",n="bg-emerald-500",d="text-emerald-400"),{score:t,label:l,percent:a,barClass:n,textClass:d}}function M({value:s}){const t=o.useMemo(()=>V(s),[s]);return s?e.jsxs("div",{className:"mt-1 space-y-1","aria-live":"polite",children:[e.jsx("div",{className:"h-2 w-full rounded-full bg-white/10 overflow-hidden",children:e.jsx("div",{className:`h-full ${t.barClass} transition-all duration-300 rounded-full`,style:{width:`${t.percent}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-white/60",children:"Password strength"}),e.jsx("span",{className:`${t.textClass}`,children:t.label})]})]}):null}function D(){const[s,t]=o.useState(""),[r,i]=o.useState({kind:"unknown",raw:""}),[a,l]=o.useState(""),[n,d]=o.useState(""),[c,x]=o.useState(!1),[g,m]=o.useState(null);async function h(j){if(j.preventDefault(),m(null),a!==n){m("Passwords do not match");return}x(!0);try{await T({identifier:r,password:a})}catch(w){m(w instanceof Error?w.message:"Sign up failed")}finally{x(!1)}}return e.jsxs("form",{onSubmit:h,className:"space-y-5 animate-fade-in-up",children:[e.jsx(N,{value:s,onChange:(j,w)=>{t(j),i(w)}}),e.jsx(y,{label:"Password",value:a,onChange:l,placeholder:"Create a strong password",autoComplete:"new-password",name:"new-password"}),e.jsx(M,{value:a}),e.jsx(y,{label:"Confirm password",value:n,onChange:d,placeholder:"Repeat password",autoComplete:"new-password",name:"confirm-password"}),g&&e.jsx("p",{className:"text-sm text-red-400",children:g}),e.jsx("button",{type:"submit",className:"btn-primary w-full pressable",disabled:c,children:e.jsx("span",{className:c?"opacity-70 animate-pulse-subtle":"",children:c?"Creating accountâ€¦":"Sign Up"})}),e.jsxs("div",{className:"relative py-2 text-center text-xs text-white/40",children:[e.jsx("span",{className:"bg-[rgb(var(--card))] px-2 relative z-10 text-primary-500",children:"or"}),e.jsx("span",{className:"absolute left-0 right-0 top-1/2 -translate-y-1/2 h-px bg-white/10"})]}),e.jsx(S,{})]})}function $(){const[s,t]=o.useState("login");return e.jsx("div",{className:"w-full max-w-sm md:max-w-sm lg:max-w-md mx-auto relative z-10",children:e.jsxs("div",{className:"glass-card p-6 md:p-8 animate-scale-in",children:[e.jsx("div",{className:"flex items-center mb-6 select-none animate-fade-in",children:e.jsx("img",{src:"/images/logos/logo.png",alt:"SmartSlate",className:"h-8 w-auto logo-glow"})}),e.jsxs("div",{className:"flex mb-6 rounded-lg bg-white/5 p-1",children:[e.jsx("button",{className:`tab pressable ${s==="login"?"tab-active":""}`,onClick:()=>t("login"),children:e.jsxs("span",{className:"relative inline-flex items-center justify-center",children:["Login",s==="login"&&e.jsx("span",{className:"absolute -bottom-[9px] left-1/2 h-0.5 w-10 -translate-x-1/2 bg-secondary-500 rounded-full"})]})}),e.jsx("button",{className:`tab pressable ${s==="signup"?"tab-active":""}`,onClick:()=>t("signup"),children:e.jsxs("span",{className:"relative inline-flex items-center justify-center",children:["Sign Up",s==="signup"&&e.jsx("span",{className:"absolute -bottom-[9px] left-1/2 h-0.5 w-10 -translate-x-1/2 bg-secondary-500 rounded-full"})]})})]}),e.jsx("div",{className:"relative",children:s==="login"?e.jsx("div",{className:"animate-fade-in-up",children:e.jsx(L,{})},"login"):e.jsx("div",{className:"animate-fade-in-up",children:e.jsx(D,{})},"signup")})]})})}export{$ as A,I as a,Y as b,v as g,z as p};
